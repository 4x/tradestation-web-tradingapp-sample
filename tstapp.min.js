
var TradingApp={init:function(){setTimeout(function(){var _parent=TradingApp;_parent.Positions.request();_parent._HashtagQueue.init();_parent.Accounts.request();_parent.Orders.request();_parent.Orders.Ticket.request();},1000);},Accounts:{request:function(){var _parent=this;TradingApp._call(function(){window.location.href=_parent._hashes._items;});},items:function(){var result=[];for(var accountID in this._items)
result.push(this._items[accountID]);return result;},item:function(accountID){return _items[accountID];},_items:{},_hashes:{_items:"#AP:AN=ITEMS;"},delegates:function(){var _parent=this;return{add:function(accountID,accountItem){var account=_parent._items[accountID];if(account==null)
_parent._items[accountID]=accountItem;else
_parent.delegates().extend(accountID,accountItem);},extend:function(accountID,accountItem){var account=_parent._items[accountID];if(account)
$.extend(account,accountItem);else
_parent.delegates().add(accountID,accountItem);},clear:function()
{_parent._items={};},next:function()
{TradingApp._next();},update:function(reason,accountID){$(TradingApp.Accounts).trigger("onUpdate",[reason,accountID]);},status:function(newState,oldState){$(TradingApp.Accounts).trigger("onStatus",[newState,oldState]);}};}},Orders:{request:function(){TradingApp._call(function(){window.location.href=TradingApp.Orders._hashes._orders;});},cancel:function(orderID){TradingApp._call(function(){window.location.href=TradingApp.Orders._hashes._cancel_order+orderID+";";});},items:function(){var result=[];for(var orderID in this._items)
result.push(this._items[orderID]);return result;},item:function(orderID){return _items[orderID];},Ticket:{ticket:{},request:function(){var _parent=this;TradingApp._call(function(){window.location.href=TradingApp.Orders._hashes._ticket;});},send:function(){var _parent=this;TradingApp._call(function(){var location=TradingApp.Orders._hashes._send_ticket+JSON.stringify(_parent.ticket)+";";window.location.href=location;});},delegates:function(){var _parent=this;return{extend:function(ticket)
{$.extend(_parent.ticket,ticket);},next:function()
{TradingApp._next();},load:function(){$(TradingApp.Orders.Ticket).trigger("onLoad",[_parent.ticket]);},send:function(){$(TradingApp.Orders.Ticket).trigger("onSend",[_parent.ticket]);}};}},delegates:function(){var _parent=this;return{add:function(orderID,orderItem){_parent._items[orderID]=orderItem;},extend:function(orderID,orderItem){var order=_parent._items[orderID];if(order)
{$.extend(order,orderItem);}},remove:function(orderID){if(_parent._items[orderID]!=null)
{delete _parent._items[orderID];}},clear:function(){_parent._items={};},next:function(){TradingApp._next();},update:function(reason,orderID){$(TradingApp.Orders).trigger("onUpdate",[reason,orderID]);},state:function(newState,oldState){$(TradingApp.Orders).trigger("onState",[newState,oldState]);}};},_items:{},_hashes:{_ticket:"#OT:AN=LOAD;",_send_ticket:"#OT:AN=SEND;TK=",_orders:"#OP:AN=LOAD;",_cancel_order:"#OP:AN=CANCEL;ID="}},Positions:{request:function(){TradingApp._call(function(){window.location.href=TradingApp.Positions._hashes._items;});},items:function(){var result=[];for(var positionID in this._items)
result.push(this._items[positionID]);return result;},item:function(positionID){return _items[positionID];},close:function(positionID){TradingApp._call(function(){window.location.href=TradingApp.Positions._hashes._close+positionID+";";});},delegates:function(){var _parent=this;return{add:function(positionID,positionItem){var position=_parent._items[positionID];if(position==null)
_parent._items[positionID]=positionItem;else
_parent.delegates().extend(positionID,positionItem);},extend:function(positionID,positionItem){var position=_parent._items[positionID];if(position)
$.extend(position,positionItem);else
_parent.delegates().add(positionID,positionItem);},remove:function(positionID){if(_parent._items[positionID]!=null)
{delete _parent._items[positionID];}},clear:function()
{_parent._items={};},next:function()
{TradingApp._next();},update:function(reason,positionID){$(TradingApp.Positions).trigger("onUpdate",[reason,positionID]);}};},_items:{},_hashes:{_items:"#PP:AN=LOAD;",_close:"#PP:AN=CLOSE;ID="}},_HashtagQueue:{_queue:[],isProcessing:false,add:function(fn){this._queue.push(fn);},process:function(){if(this.isProcessing==false)
{var fn=null;if(this._queue.length>0)
fn=this._queue.shift();if(fn!=null)
{fn();$("#eventsContent").append("process queue:"+this._queue.length.toString()+"<br/>");this.isProcessing=true;}}},next:function(){this.isProcessing=false;this.process();},init:function(){}},_call:function(fn){this._HashtagQueue.add(fn);this._HashtagQueue.process();},_next:function(){this._HashtagQueue.next();}};function taPPtest(a,b){$("#eventsContent").append("Testing Invoke <br/>");}
function taPPadd(positionID,positionItem){alert(positionID);TradingApp.Positions.delegates().add(positionID,positionItem);};function taPPupdate(reason,positionItem){TradingApp.Positions.delegates().update(reason);};